%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Réglage de chemfig
\setchemfig{
  atom sep=24pt,
  bond style={line width=1pt},
  angle increment=30
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Pour faire des parenthèses dans les molécules 
\def\parentheseG{\llap{$\left(\strut\right.$}}
\def\parentheseD{\rlap{$\left.\strut\right)$}}

%% Pour avoir des molécules en gras dans un texte
\newcommand{\moleculesGras}{
  \renewcommand*\printatom[1]{\ensuremath{\mathbf{##1}}}
}
\newcommand{\moleculesNormale}{
  \renewcommand*\printatom[1]{\ensuremath{\mathrm{##1}}}
}
\newcommand{\chemfigHaworth}[1]{
  \chemfig[cram width=2.2pt, atom sep=2.em]{ #1 }
}

%%%% Éléments récurrents 
\newcommand{\hydrogene}{\chemfig{H}\xspace}
\newcommand{\carbone}  {\chemfig{C}\xspace}
\newcommand{\oxygene}  {\chemfig{O}\xspace}
\newcommand{\azote}    {\chemfig{N}\xspace}
\newcommand{\electron} {\chemfig{e^{-}}\xspace}
%%%% Molécules récurrentes
\newcommand{\dioxygene}          {\chemfig{O_2}\xspace}
\newcommand{\diazote}            {\chemfig{N_2}\xspace}
\newcommand{\dioxydeDeCarbone}   {\chemfig{CO_2}\xspace}
\newcommand{\eau}                {\chemfig{H_2O}\xspace}
\newcommand{\methane}            {\chemfig{CH_4}\xspace}
\newcommand{\ammoniac}           {\chemfig{NH_3}\xspace}
\newcommand{\diiode}             {\chemfig{I_2}\xspace}
\newcommand{\acideCarbonique}    {\chemfig{H_2CO_3}\xspace}
\newcommand{\carbonateDeCalcium} {\chemfig{CaCO_3}\xspace}
\newcommand{\bicarbonateDeSodium}{\chemfig{NaHCO_3}\xspace}
\newcommand{\azotureDeSodium}    {\chemfig{NaN_3}\xspace}
\newcommand{\chlorureDArgent}    {\chemfig{AgCl}\xspace}
%%%% Ions récurrents
\newcommand{\oxonium}     {\chemfig{H_3O^{+}}\xspace}
\newcommand{\hydroxyde}   {\chemfig{HO^{-}}\xspace}
\newcommand{\ionHydrogene}{\chemfig{H^{+}}\xspace}
\newcommand{\ammonium}    {\chemfig{NH_4^{+}}\xspace}
\newcommand{\nitrate}     {\chemfig{NO_3^{-}}\xspace}
\newcommand{\sulfate}     {\chemfig{SO_4^{2-}}\xspace}
\newcommand{\chlorure}    {\chemfig{Cl^{-}}\xspace}
\newcommand{\fluorure}    {\chemfig{F^{-}}\xspace}
\newcommand{\carbonate}   {\chemfig{CO_3^{2-}}\xspace}
\newcommand{\bicarbonate} {\chemfig{HCO_3^{-}}\xspace}
\newcommand{\ionOxygene}  {\chemfig{O^{2-}}\xspace}
\newcommand{\ionFerII}    {\chemfig{Fe^{2+}}\xspace}
\newcommand{\ionFerIII}   {\chemfig{Fe^{3+}}\xspace}
\newcommand{\ionSodium}   {\chemfig{Na^{+}}\xspace}
\newcommand{\ionArgent}   {\chemfig{Ag^{+}}\xspace}
\newcommand{\hypochlorite}{\chemfig{ClO^{-}}\xspace}
\newcommand{\ionCuivreII} {\chemfig{Cu^{2+}}\xspace}
\newcommand{\ionCalcium}  {\chemfig{Ca^{2+}}\xspace}
\newcommand{\ionMagnesium}{\chemfig{Mg^{2+}}\xspace}
\newcommand{\ionPotassium}{\chemfig{K^{+}}\xspace}

%%%% État physique
\newcommand{\aq} { \ensuremath{_\text{(aq)}} }
\newcommand{\sol}{ \ensuremath{_\text{(s)}} }
\newcommand{\liq}{ \ensuremath{_\text{(l)}} }
\newcommand{\gaz}{ \ensuremath{_\text{(g)}} }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Pour simplifier certaines molécules
\definesubmol\blank{ -[,,,, draw = none] } % liaison invisible
\definesubmol\vide1{ -[#1,,,, draw = none] } % liaison invisible avec angle réglable
\definesubmol\ch   { -[::60] }  % C-C vers le haut (carbone haut)
\definesubmol\cb   { -[::-60] } % C-C vers le bas (carbone bas)
\definesubmol\chb  { -[::60] -[::-60] } % Liaison C-C-C ^ (carbone haut bas)
\definesubmol\cbh  { -[::-60] -[::60] } % Liaison C-C-C v (carbone bas haut)
\definesubmol\cch  { =[::60] }  % Liaison C=C vers le haut
\definesubmol\ccb  { =[::-60] } % Liaison C=C vers le bas
\definesubmol\cis  { -[::60] =[::-60] -[::-60] } % Liaison -C=C- cis
\definesubmol\trans{ -[::60] =[::-30] -[::-30] } % Liaison -C=C- trans
%% Hydrogènes saturés
\definesubmol\HH {(-[::90] H) (-[::-90] H)} % paire H- R -H
\definesubmol\HHH{(-[::90] H) (-[::-90] H) (-[::0] H)} % triplet H- RH -H
%% Quelques groupes caractéristiques
\definesubmol\teteAcide   { O-[::30] (=[::60] O) -[::-60] }
\definesubmol\teteAcideDev{ -O-C (=[::90] O) - }
\definesubmol\carboxyle   { (=[::-60] O) (-[::60] OH) }
\definesubmol\carboxyleDev{ (=[::-50] O) (-[::50] OH) }
\definesubmol\carbonyle   { (=[::60] O) -[::-60] }
\definesubmol\carbonyleDev{ (=[::50] O) -[::-50] }
\definesubmol\ester       { (=[:90] O) -[:-30] O}
\definesubmol\ether       { -[:30] O -[:-30]}
\definesubmol\amide       { (=[:90] O) -[:-30] N}
\definesubmol\phosphate   { P (=[::-90] O) (-[::90] \charge{45:1.5pt=$\scriptstyle-$}{O}) -[::0] O}

%%%% Pour des molécules colorées
\definesubmol\chCouleur {-[ ::60,,,, couleurQuat, line width = 1.5pt]}
\definesubmol\cbCouleur {-[::-60,,,, couleurQuat, line width = 1.5pt]}
\definesubmol\cchCouleur{=[ ::60,,,, couleurQuat, line width = 1.5pt]}
\definesubmol\ccbCouleur{=[::-60,,,, couleurQuat, line width = 1.5pt]}
\definesubmol\couleur1  {\textcolor{couleurQuat}{#1}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Acides gras
\definesubmol\palmitique{
  H !\teteAcide !\chb !\chb !\chb !\chb !\chb !\chb !\chb
}
\definesubmol\linolenique{
  H !\teteAcide !\chb !\chb !\chb !\trans !\trans !\trans !\ch
}
\definesubmol\oleique{
  H !\teteAcide !\chb !\chb !\chb !\cis !\ch !\chb !\chb !\chb
}
\definesubmol\linoleique{
  H !\teteAcide !\chb !\chb !\chb !\cis !\cis !\chb !\chb
}
\definesubmol\arachidonique{
  H !\teteAcide !\chb !\cis !\cis !\cis !\cis !\ch !\chb !\ch
}
\definesubmol\eicosaPentaenoique{
  H !\teteAcide !\ch !\ch !\cis !\cis !\cis !\cis !\cis !\ch
}
\definesubmol\docosaHexanoique{
  H !\teteAcide !\ch !\cis !\cis !\ch =[::60] !\ch !\cis !\cis !\cis !\ch
}
\definesubmol\oleiqueSemiDev  { C_{17} H_{33} -C !\carboxyleDev }
\definesubmol\oleateSemiDev   { C_{17} H_{33} -C (=[::-50] O) (-[::50] O^{-}) }
\definesubmol\steraiqueSemiDev{ C_{17}H_{35} -C !\carboxyleDev }
\definesubmol\caproiqueSemiDev{ CH_2 - CH_2 - CH_2 - CH_2 - CH_2 - C !\carboxyleDev }
%% Pour l'utilisation dans les triglycérides
\definesubmol\tripalmitique { !\cbh !\cbh !\cbh !\cbh !\cbh !\cbh !\cb }
\definesubmol\trilinolenique{ !\chb !\chb !\chb !\cis !\cis !\cis !\ch }
\definesubmol\trioleique    { !\chb !\chb !\chb !\ch !\cch !\ch !\chb !\chb !\cb !\cb !\cb }
\definesubmol\trilinoleique { !\chb !\chb !\chb !\cis !\cis !\chb !\chb }
%% Formes semi-developpées
\definesubmol\tristeraiqueSemiDev { !\teteAcideDev C_{17} H_{35} }
\definesubmol\tricaproiqueSemiDev { !\teteAcideDev CH_2 - CH_2 - CH_2 - CH_2 - CH_3 }
\definesubmol\trioleiqueSemiDev   { !\teteAcideDev C_{17} H_{33} }
\definesubmol\tripalmitiqueSemiDev{ !\teteAcideDev C_{15} H_{31} }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Lipide
\definesubmol\oleine{
   (-[::150] !\ch O !\cb !\carbonyle !\trioleique)
   (-[::-90] !\cb O!\ch !\carbonyle !\trioleique)
   -[::30] O!\ch !\carbonyle !\trioleique
}
\definesubmol\palmitine{
   (-[::150] !\ch O !\cb !\carbonyle !\tripalmitique !\ch) % haut
   (-[::-90] !\ch O !\ch (!\ccb O) !\ch !\tripalmitique !\ch) % bas
   -[::30] O!\ch !\carbonyle !\ch !\tripalmitique % centre
}
\definesubmol\phosphatidylcholine{
  % choline
  -[::-30] \charge{90:4pt=$+$}{N}
    (-[::-30])(-[::-90])
  % phosphate
  !\chb !\ch O !\cb P
    ( =[::-20]O )( -[::-100]\charge{140:2pt=$-$}{O} )
  % diglycéride
  !\ch O !\cb !\ch (!\ch O !\cb !\carbonyle !\trioleique)
  !\cb !\ch O !\cb (!\ccb O) !\chb !\chb !\chb !\chb !\chb
}
\definesubmol\oleineSemiDev{
  H C                 (!\trioleiqueSemiDev)
  (-[3,1.7,2,2] H_2C  (!\trioleiqueSemiDev))
  -[-3,1.7,2,2] H_2 C (!\trioleiqueSemiDev)
}
\definesubmol\caproineSemiDev{
  H C                 (!\tricaproiqueSemiDev)
  (-[3,1.7,2,2] H_2C  (!\tricaproiqueSemiDev))
  -[-3,1.7,2,2] H_2 C (!\tricaproiqueSemiDev)
}
\definesubmol\palmitineSemiDev{
  H C                 (!\tripalmitiqueSemiDev)
  (-[3,1.7,2,2] H_2C  (!\tripalmitiqueSemiDev))
  -[-3,1.7,2,2] H_2 C (!\tripalmitiqueSemiDev)
}

%% glycérol
\definesubmol\glycerol{
  HO !\cbh (!\ch OH) !\cbh OH
}
\definesubmol\glycerolSemiDev{
  HC (-OH)
  (-[3,,2,2] H_2C (-OH))
  -[-3,,2,2] H_2C (-OH)
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Stérols
\definesubmol\cholesterol{
  HO-[1] *6(-- % 1er cycle
    *6(=-- % 2eme cycle
      *6(- % 3eme cycle
        *5(--- 
          (-[::-35] (!\ch) !\cb !\cb !\chb (!\cb) !\ch) % lipide
          -  -
        ) % 4eme
        - (-[::0]) ---
      ) % 3eme
      ---
    ) % 2eme
    - (-[::0]) ---
  ) % 1er
}
\definesubmol\testosterone{
  O=[1] *6(-=
    *6(---
      *6(-
        *5(--- (- OH) --) % 4
      - (-[::0]) ---
      ) % 3
    ---
    ) % 2
  - (-[::0]) ---
  ) % 1
}
\definesubmol\cortisol{
  O=[::30] *6(
    -= *6(
      --- *6(
        - *5(
          --- (-[::-100] OH)
          (-[::-35] (!\cch O) !\cb!\ch OH)
          -
        ) % 4
        - (-[::0]) -- (-OH) -
      ) % 3
      --
    ) % 2
    - (-[::0]) ---
  ) % 1
}
\definesubmol\progesterone{
  O=[::30] *6(
    -=  *6(
      --- *6(
        - *5(--- (=O) -)
        - (-[::0])
        ---
      ) % 3
      --
    ) % 2
    - (-[::0]) ---
  ) % 1
}

\definesubmol\estradiol{
    HO-[::30] *6(
    -= *6(
      --- *6(
        - *5(--- (-OH) -)
        - (-[::0]) ---
      ) % 3
      --
    ) % 2
    -=-=
  ) % 1
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Glucides
%% Pour la représentation de Haworth du glucose ou du fructose
\definesubmol\gluHaw{
  -[:90,0.01,,,draw = none]
  %% Bas du cycle
  <[::-140,0.9] (-[::140,0.7] OH) 
  -[::50,1.1,,,line width=3pt] (-[::-90,0.7] OH)
  >[::45,0.9]
  %% haut du cycle
  -[::90,0.9]O -[::45] (-[::-90,0.5] -[::60,0.7,,2] HO) -[::40,0.9]
  %% pour retourner sur la droite du cycle
  -[::180,0.9,,, draw = none] -[::-40,1,,, draw = none] -[::-45,0.9,,, draw = none]
}
\definesubmol\fruHaw{
  -[:90,0.01,,,draw = none]
  %% Bas du cycle
  <[::-140,0.9] (-[::140,0.7] OH) 
  -[::50,1.1,,,line width=3pt] (-[::-90,0.7] OH)
  >[::45,0.9]
  %% haut du cycle
  -[::90,0.9]O -[::45] -[::40,0.9]
  %% pour retourner sur la droite du cycle
  -[::180,0.9,,, draw = none] -[::-40,1,,, draw = none] -[::-45,0.9,,, draw = none]
}

%%% Amidon
\definesubmol\amylopectineHaw{
  %% Glucoses du haut
  \cbots\phantom{O} -[::-20,1.4] O-[::30,0.8] !\gluHaw 
  -[::30,0.8] O-[::30,0.8] !\gluHaw
  -[::30,0.8] O-[::-75,1.2] 
  %% Haut du Centre
  O-[::60,0.7] -[::-60,0.7] -[::90] O-[::-45,0.9] (
    %% Glucoses à droite
    -[::30,0.8] O-[::30,0.8] !\gluHaw -[::30,0.8] O-[::30,1.4] \phantom{O}\cbots
  )
  %% Bas du centre
  <[::-90,0.9] (-[::45,0.7] OH)
  -[::-45,1.1,,,line width=3pt] (-[::-90,0.7] OH)
  >[::-45,0.9]
  -[::-95] -[::180] % pour revenir à gauche du cycle
  %% Glucose à gauche
  -[::-20,0.8] O-[::-40,0.8]
  <[::65,0.9] (-[::45,0.7] OH)
  -[::-45,1.1,,,line width=3pt] (-[::-90,0.7] OH)
  >[::-45,0.9] (-[::60,0.8] O-[::-30,1.4] \phantom{O}\cbots)
  -[::-95,0.9] (-[::50,0.5] -[::60,0.7,,2] HO) -[::-40,1.1] O-[::-45,0.9]
}
%% Pour faciliter l'écriture d'un sucre en formule développée
\definesubmol{\ose} { -[::0] C (-[::-90] H) (-[::90] OH) }

%% glucose
\definesubmol\glucoseHaw{
  HO -[::90,0.9,2] !\gluHaw -[::-45,0.7,,1] OH
}
\definesubmol\glucoseCycle{
  HO -[::30] *6 (-(-OH) -(-OH) -(-OH) -O- (- !\cb OH)-)
}
\definesubmol\glucose{
  H -[::30] (!\cch O) !\cb (!\cb OH) !\ch (!\ch OH) !\cb (!\cb OH) !\ch (!\ch OH) !\cb !\ch OH
}
\definesubmol\glucoseSemiDev{
  C (-[::120] H) (=[::-120] O) !\ose !\ose !\ose !\ose !\ose (-[::0] OH)
}

%% fructose
\definesubmol\fructoseHaw{
  HO -[::90,0.9,2] !\fruHaw (-[::130,0.7,,1] OH) -[::-45,0.7] -[::60,0.7,,1] OH
}
\definesubmol\fructoseCycle{
  HO -[::30] *6 (-(-OH) -(-OH) -(-[::0] OH) (-[::-90] !\ch OH) -O--)
}
\definesubmol\fructose{
  HO -[::30] !\cb (!\ccb O) !\ch (!\ch OH) !\cb (!\cb OH) !\ch (!\ch OH) !\cb !\ch OH
}
\definesubmol\fructoseSemiDev{
  OH -[::0]  C!\HH -[::0] C (=[::90] O) !\ose !\ose !\ose !\ose (-[::0] H)
}

%%%% Ribose
\definesubmol{\ribose}{
  % liaison à droite et cycle
  -[::-30] !\cb *5([::70]- (-HO) -(-OH) --O-)
  % imite les angles du cycle pour pouvoir ajouter une chaîne à gauche
  !\vide{::124} !\vide{::-72} -[::128]
}
\definesubmol{\riboseHaw}{
  % liaison à droite
  -[::-30] !\cb
  % cycle ouvert et fermé par ? (4 liaisons à tracer du coup)
  ? <[::30,0.7] (!\cb HO) -[::60,,,,line width= 3pt] (!\cb OH) >[::60, 0.7] -[::90]O ?
  % on repart à l'envers de l'oxygène pour pouvoir ajouter une chaîne à gauche
  !\vide{::180} -[::120]
}
\definesubmol{\desoxyribose}{
  % liaison à droite et cycle
  -[::-30] !\cb *5([::70]- (-HO) ---O-)
  % imite les angles du cycle pour pouvoir ajouter une chaîne à gauche
  !\vide{::124} !\vide{::-72} -[::128]
}
\definesubmol{\desoxyriboseHaw}{
  % liaison à droite
  -[::-30] !\cb
  % cycle ouvert et fermé par ? (4 liaisons à tracer du coup)
  ? <[::30,0.7] (!\cb HO) -[::60,,,,line width= 3pt] >[::60, 0.7] -[::90]O ?
  % on repart à l'envers de l'oxygène pour pouvoir ajouter une chaîne à gauche
  !\vide{::180} -[::120]
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Base nucléique
\definesubmol{\adenine} { *5(- *6(-N=-N= (-[,,,1]NH_2) -) =-N=-) }
\definesubmol{\guanine} { *5(- *6(-N= (-[,,,1]NH_2) -[,,,1] NH -(=O)-) =-N=-) }
\definesubmol{\thymine} { *6(- (=O) -[,,,1] NH -(=O) -(-)=-) }
\definesubmol{\uracile} { *6(- (=O) -[,,,1] NH -(=O) -=-) }
\definesubmol{\cytosine}{ *6(- (=O) -N= (-NH_2) -=-) }

%%% Ribonucléoside
\definesubmol{\adenosine}{ !\ribose N !\adenine }
\definesubmol{\cytidine} { !\ribose N !\cytosine }
\definesubmol{\guanosine}{ !\ribose N !\guanine }
\definesubmol{\thymidine}{ !\ribose N !\thymine }
\definesubmol{\uridine}  { !\ribose N !\uracile }
%%
\definesubmol{\adenosineHaw}{ !\riboseHaw N !\adenine }
\definesubmol{\cytidineHaw} { !\riboseHaw N !\cytosine }
\definesubmol{\guanosineHaw}{ !\riboseHaw N !\guanine }
\definesubmol{\thymidineHaw}{ !\riboseHaw N !\thymine }
\definesubmol{\uridineHaw}  { !\riboseHaw N !\uracile }
%% Desoxyribonucléoside
\definesubmol{\desoxyAdenosine}{ !\desoxyribose N !\adenine }
\definesubmol{\desoxyCytidine} { !\desoxyribose N !\cytosine }
\definesubmol{\desoxyGuanosine}{ !\desoxyribose N !\guanine }
\definesubmol{\desoxyThymidine}{ !\desoxyribose N !\thymine }
\definesubmol{\desoxyUridine}  { !\desoxyribose N !\uracile }
%%
\definesubmol{\desoxyAdenosineHaw}{ !\desoxyriboseHaw N !\adenine }
\definesubmol{\desoxyCytidineHaw} { !\desoxyriboseHaw N !\cytosine }
\definesubmol{\desoxyGuanosineHaw}{ !\desoxyriboseHaw N !\guanine }
\definesubmol{\desoxyThymidineHaw}{ !\desoxyriboseHaw N !\thymine }
\definesubmol{\desoxyUridineHaw}  { !\desoxyriboseHaw N !\uracile }

%%%% Adenosine Tri-Phosphate et Adenosine Di-Phosphate
\definesubmol{\tetePhosphate}{ \charge{45:1.5pt=$\scriptstyle -$}{O} -!\phosphate }
\definesubmol{\ADP}{ !\tetePhosphate -!\phosphate !\adenosine }
\definesubmol{\ATP}{ !\tetePhosphate -!\phosphate -!\phosphate !\adenosine}
\definesubmol{\ADPHaw}{ !\tetePhosphate !\adenosineHaw }
\definesubmol{\ATPHaw}{ !\tetePhosphate -!\phosphate -!\phosphate !\adenosineHaw}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Acides alpha aminés, formules topologiques
\definesubmol\acideAmine1{ H_2N -[::30] (#1) !\cb !\carboxyle }
\definesubmol\arginine       { !\acideAmine{!\ch!\chb!\ch HN -[::-60,,2] (!\cb NH_2) !\cch H_2N^{+}} }
\definesubmol\histidine      { !\acideAmine{!\ch!\ch *5(-N=-HN-=)} }
\definesubmol\lysine         { !\acideAmine{!\ch!\chb!\chb NH_3^{+}} }
\definesubmol\acideAspartique{ !\acideAmine{!\ch!\ch !\carbonyle O^{-}} }
\definesubmol\acideGlutamique{ !\acideAmine{!\ch!\chb !\carbonyle O^{-}} }
\definesubmol\serine         { !\acideAmine{!\ch!\ch HO} }
\definesubmol\threonine      { !\acideAmine{!\ch (!\ch HO) !\cb} }
\definesubmol\asparagine     { !\acideAmine{!\ch!\ch (!\ccb O) !\ch H_2N} }
\definesubmol\glutamine      { !\acideAmine{!\ch!\chb (!\cch O) !\cb H_2N} }
\definesubmol\cysteine       { !\acideAmine{!\ch!\ch HS} }
\definesubmol\selenocysteine { !\acideAmine{!\ch!\ch HSe} }
\definesubmol\glycine        { !\acideAmine{} }
\definesubmol\proline        { !\acideAmine{!\ch *5(----HN-)} }
\definesubmol\alanine        { !\acideAmine{!\ch} }
\definesubmol\valine         { !\acideAmine{!\ch (!\cb) !\ch} }
\definesubmol\isoleucine     { !\acideAmine{!\ch (!\cb) !\chb} }
\definesubmol\leucine        { !\acideAmine{!\ch!\ch (!\cb) !\ch} }
\definesubmol\methionine     { !\acideAmine{!\ch!\ch!\cb S !\ch} }
\definesubmol\phenylalanine  { !\acideAmine{!\ch!\ch *6(=-=-=-)} }
\definesubmol\tyrosine       { !\acideAmine{!\ch!\ch *6(=-=(-OH)-=-)} }
\definesubmol\tryophane      { !\acideAmine{!\ch!\ch *5(- *6(-=-=-) =-HN-=)} }
%% Acides alpha aminés, formules semi-developpée
\definesubmol\acideAmineSD{ CH (-[::-90] NH_2) -C !\carboxyleDev }
\definesubmol\alanineSemiDev   { CH_3 - !\acideAmineSD }
\definesubmol\asparagineSemiDev{ C (=[::-120] O) (-[::120] H_2N) -CH_2 -CH_2 - !\acideAmineSD }
\definesubmol\glycineSemiDev   { CH_2 - !\acideAmineSD }
\definesubmol\cysteineSemiDev  { HS -CH_2 - !\acideAmineSD }

%% Pour faire des polypeptides en formule topologique H = haut, B = bas
\definesubmol\acideAmineH1{ !\ch (#1) !\cb (!\ccb O) !\ch }
\definesubmol\acideAmineB1{ !\cb (#1) !\ch (!\cch O) !\cb }
\definesubmol\arginineH       { !\acideAmineH{!\ch!\chb!\ch HN -[::-60,,2] (!\cb NH_2) !\cch H_2N^{+}} }
\definesubmol\arginineB       { !\acideAmineB{!\cb!\cbh!\cb HN -[::60,,2]  (!\ch NH_2) !\ccb H_2N^{+}} }
\definesubmol\histidineH      { !\acideAmineH{!\ch!\cb *5(-N=-\chemabove{N}{H}-=)} }
\definesubmol\histidineB      { !\acideAmineB{!\cb!\ch *5(-N=-HN-=)} }
\definesubmol\lysineH         { !\acideAmineH{!\ch!\chb!\chb NH_3^{+}} }
\definesubmol\lysineB         { !\acideAmineB{!\cb!\cbh!\cbh NH_3^{+}} }
\definesubmol\acideAspartiqueH{ !\acideAmineH{!\ch!\cb !\carbonyle O^{-}} }
\definesubmol\acideAspartiqueB{ !\acideAmineB{!\cb!\ch !\carbonyle O^{-}} }
\definesubmol\acideGlutamiqueH{ !\acideAmineH{!\ch!\chb !\carbonyle O^{-}} }
\definesubmol\acideGlutamiqueB{ !\acideAmineB{!\cb!\cbh !\carbonyle O^{-}} }
\definesubmol\serineH         { !\acideAmineH{!\ch!\cb HO} }
\definesubmol\serineB         { !\acideAmineB{!\cb!\ch HO} }
\definesubmol\threonineH      { !\acideAmineH{!\ch (!\cb HO) !\ch} }
\definesubmol\threonineB      { !\acideAmineB{!\cb (!\ch HO) !\cb} }
\definesubmol\asparagineH     { !\acideAmineH{!\ch!\cb (!\ccb O) !\ch NH_2} }
\definesubmol\asparagineB     { !\acideAmineB{!\cb!\ch (!\cch O) !\cb NH_2} }
\definesubmol\glutamineH      { !\acideAmineH{!\ch!\chb (!\cch O) !\cb H_2N} }
\definesubmol\glutamineB      { !\acideAmineB{!\cb!\cbh (!\ccb O) !\ch H_2N} }
\definesubmol\cysteineH       { !\acideAmineH{!\ch!\cb HS} }
\definesubmol\cysteineB       { !\acideAmineB{!\cb!\ch HS} }
\definesubmol\selenocysteineH { !\acideAmineH{!\ch!\cb HSe} }
\definesubmol\selenocysteineB { !\acideAmineB{!\cb!\ch HSe} }
\definesubmol\prolineH        { !\acideAmineH{!\ch *5(----HN-)} }
\definesubmol\prolineB        { !\acideAmineB{!\cb *5(----HN-)} }
\definesubmol\alanineH        { !\acideAmineH{!\ch} }
\definesubmol\alanineB        { !\acideAmineB{!\cb} }
\definesubmol\valineH         { !\acideAmineH{!\ch (!\cb) !\ch} }
\definesubmol\valineB         { !\acideAmineB{!\cb (!\cb) !\ch} }
\definesubmol\isoleucineH     { !\acideAmineH{!\ch (!\cb) !\cbh} }
\definesubmol\isoleucineB     { !\acideAmineB{!\cb (!\cb) !\chb} }
\definesubmol\leucineH        { !\acideAmineH{!\ch!\cb (!\cb) !\ch} }
\definesubmol\leucineB        { !\acideAmineB{!\cb!\ch (!\cb) !\ch} }
\definesubmol\methionineH     { !\acideAmineH{!\ch!\cb!\ch S !\cb} }
\definesubmol\methionineB     { !\acideAmineB{!\cb!\ch!\cb S !\ch} }
\definesubmol\phenylalanineH  { !\acideAmineH{!\ch!\cb *6(=-=-=-)} }
\definesubmol\phenylalanineB  { !\acideAmineB{!\cb!\ch *6(=-=-=-)} }
\definesubmol\tyrosineH       { !\acideAmineH{!\ch!\cb *6(=-=(-OH)-=-)} }
\definesubmol\tyrosineB       { !\acideAmineB{!\cb!\ch *6(=-=(-OH)-=-)} }
\definesubmol\tryophaneH      { !\acideAmineH{-[::70]-[::-40] *5(- *6(-=-=-) =-\chemabove{N}{H}-=)} }
\definesubmol\tryophaneB      { !\acideAmineB{!\cb!\ch *5(- *6(-=-=-) =-NH-=)} }
%% Pour faire des polypeptides en formule semi-développée
%% SD = semi-dev ; H = haut ; B = bas
\definesubmol\acideAmineSDH1{-CH (#1) -C (=[::-90] O) -}
\definesubmol\acideAmineSDB1{-CH (#1) -C (=[::90] O) -}
\definesubmol\cysteineSemiDevH  { !\acideAmineSDH{-[::90]  CH_2 -[::0] HS } }
\definesubmol\cysteineSemiDevB  { !\acideAmineSDB{-[::-90] CH_2 -[::0] HS } }
\definesubmol\alanineSemiDevH   { !\acideAmineSDH{-[::90]  CH_3} }
\definesubmol\alanineSemiDevB   { !\acideAmineSDB{-[::-90] CH_3} }
\definesubmol\isoleucineSemiDevH{ !\acideAmineSDH{-[::90]  CH (!\ch H_2C -[::-60,,2,2]H_3C) !\cb CH_2 } }
\definesubmol\isoleucineSemiDevB{ !\acideAmineSDB{-[::-90] CH (!\ch CH_2 !\cb CH_3) !\cb H_2C } }
\definesubmol\valineSemiDevH    { !\acideAmineSDH{-[::90]  CH (!\ch H_3C) !\cb CH_2} }
\definesubmol\valineSemiDevB    { !\acideAmineSDB{-[::-90] CH (!\cb H_3C) !\ch CH_2} }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Hormones
\definesubmol\creatinine{
  O= *5(-N (-[-3,0.5]H) -(=NH) -N (-) --)
}
\definesubmol\DOPA{
  HO -[1] *6(= (-OH) -= (--[-1] (-[-3] NH_2) -[1] !\carboxyle) -=-)
}
\definesubmol\DOPAH{
  HO -[1] *6(= (-OH) -= (--[-1] (-[-3] NH_3^+) -[1] !\carboxyle) -=-)
}
\definesubmol\prostaglandine{
  HO-[::75] *5(
    - (-!\cch !\cb (!\cb HO) !\chb !\chb !\ch)
    - (-[::-65] !\cbh !\cbh !\cbh !\carboxyle)
    - (=O)
    --
  )
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Produit de contraste
\definesubmol\chelate{-[::-70] -[::80] -[::80]} 
\definesubmol\chelateCOO{-[::-120] !\cb (!\ccb O) !\ch O^{-}}
\definesubmol\ionChelate{
  [:-10] N (-[::50, 0.9,,, draw = none] Gd^{3+})
    (!\chelateCOO) !\chelate
  N (!\chelateCOO) !\chelate
  N (!\chelateCOO) !\chelate 
  N (!\chelateCOO) -[::-70] -[::80] -[::80,0.75]
}
\definesubmol\chelateAlcool{
  [:-10] N (-[::50, 0.9,,, draw = none] Gd^{3+})
    (!\chelateCOO) !\chelate
  N (!\chelateCOO) !\chelate
  N (-[::-120] !\cb (!\cb) !\ch O) !\chelate 
  N (!\chelateCOO) -[::-70] -[::80] -[::80,0.75]
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Vitamines
\definesubmol\acideAscorbique{ % Vitamine C
  HO-[-1] -[1](-[3]OH) -[-1] 
  *5(
    -(-OH) =(-OH) -(=O) -O-
  )
}
\definesubmol\cholecarciferol{ % Vitamine D
  OH-[-1]
  *6( % 1er cycle
    ---(=)- ( % ramification
      = !\cb !\cch *6(- % 2eme
        *5(
          --- (-(-[::60]) !\cb !\chb -[::60](-[::60]) !\cb) --
        ) % 3eme
        -(-[::0])----
      ) % 2eme
    ) % ramification
    --
  ) % 1er
}
\definesubmol\cret{ !\ccb !\ch }
\definesubmol\retinol{ % Vitamine A
  *6( % cycle
    --(-[::0]) (-[::-80]) = ( % chaine
      !\cb !\cret (!\ch) !\cret !\cret (!\ch) !\cret !\cb OH
    ) % chaine
    -(-)--
  ) % cycle
}
% vitamine B1 thiamine
\definesubmol\thiamine{
  -[::30]  *6(
    -N=- (
      - !\cb N  *5(
        - (-)
        = (- !\ch !\cb OH)
        -S-=
      ) % 2nd cycle
    )
    = (-  NH_2)
    -N=
  ) % 1er cycle
}
% vitamine B2 riboflavine
\definesubmol\riboflavine{
  -[::30]  *6(
    =- ( *6(
        - N (
        !\cbh (!\ch OH)
        !\cb (!\cb OH)
        !\ch (!\ch OH)
        !\cb !\ch OH
      )
      - ( *6(=N- (=O) -NH- (= O)-) )
      -=N-
    ))
    =-= (-) -
  )
}
% vitamine B3 acide nicotinique
\definesubmol\acideNicotinique{
   *6(-N=- (- (!\cch O) !\cb OH) =-=)
}
% vitamine B5 acide panthotenique
\definesubmol\acidePanthotenique{
  HO -[::30] !\cb (-[::-90]) (-[::-30])
  !\ch ( !\ch OH )
  !\cb (!\ccb O )
  !\ch \chemabove{N}{H} !\cbh !\cb (!\ccb O)
  !\ch OH
}
% vitamine B6 pyroxidine
\definesubmol\pyroxidine{
  HO -[::30] !\cb  *6(
    =-N= (-)
    - (-OH)
    = (!\cb OH)
    -
  )
}
% vitamine B8 biotine
\definesubmol\biotine{
  \chembelow{N}{H} *5(
    - *5(--S- (- !\cbh !\cb) -)
    --\chemabove{N}{H}- (= HO)
    -
  )
}
% vitamine B9 acide folique
\definesubmol\acideFolique{
  H_2N -[::30]  *6(
    =N- *6(
      -N=- (
        - !\ch \chemabove{N}{H} !\cb  *6(
          =-= (
            - (!\cch O)
            !\cb \chembelow{N}{H} !\ch (!\ch (!\ch HO) !\ccb O)
            !\cb !\cbh (!\ch OH) !\ccb O
          )
          -=-
        ) % 3eme cycle
      )
      =N-
    ) % 2nd cycle
    =- (=O) -N-
  ) % 1er cycle
}
% vitamine B12 cyanocobalamine
\definesubmol\cyanocobalamine{
  -[::-5]  *5( % cycle haut droit du cobalt
    (-[::150] -[::-50] (!\ccb O) !\ch NH_2)
    - (-[::-90]) (-[::-35])
    - N = (
      - (!\ch) !\ccb *5( % cycle haut gauche du cobalt
        - N = (
          -!\ccb *5( % cycle bas gauche du cobalt
            - N = (
              - (!\ch) !\ccb *5( % cobalt
                - N (-Co !\ch CN)
                -- (- !\cb (!\ccb O) !\ch NH_2)
                - (-[::-90]) ( % Phosphate
                  - !\chb (!\ccb O) !\ch NH !\cbh (!\ch)
                  !\cb O !\ch !\phosphate -[::0] *5( % cycle du bas ether
                    - (- !\ch HO)
                    -O- (-N  *5(- *6(=-(-)=(-)-=) --N=-)) % Cycle du bas amidine
                    -(-OH)-
                  )
                )
                -
              )
            ) % amide latéral
            - (- !\chb (!\ccb O) !\ch NH_2)
            - (-[::-30])  (-[::-90]) -
          )
        ) % cycle 
        - (- !\cbh (!\cch O) !\cb NH_2)
        - (-[::0]) (!\cb!\cb (!\cch O) !\cb NH_2)
        -
      )
    )
    - (- !\cbh (!\ccb O) !\ch NH_2)
    - 
  ) % 1er cycle
}
% vitamine E
\definesubmol\vitamineE{
  -[::30]  *6(
    = (-) -  *6(
      -O- (
        - !\chb !\ch (!\ch)
        !\cbh !\cbh (!\ch)
        !\cbh !\cbh (!\ch) !\cb
      )
      ( -[::0] )
      ---
    ) % 2nd cycle
    =- (-) = ( -HO )
    -
  ) % 1er cycle
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Aspirine
\definesubmol\aspirineSemiDev{
  HC *6( % cycle
    -\chembelow{C}{H} =CH -C (
      -O !\cb C (!\ccb O) !\ch CH_3 % chaine latérale
    )
    =C (-C !\carboxyle) -[,,,2]HC =[,,2]
  ) % cyle
}
\definesubmol\aspirine{
  *6 (-=- (-O !\cb (!\ccb O) !\ch) = (- !\carboxyle) -=)
}
\definesubmol\acideSalicylique{
  *6 (-=- (-OH) = (- !\carboxyle) -=)
}

%% Paracétamol
\definesubmol\paracetamol{
  HO -[::30] *6(
    -=- (
      -\chemabove{N}{H} (!\cb (!\ccb O) !\ch) % amide
    )
    =-=
  )
}
\definesubmol\paracetamolSemiDev{
  HO -[::30] C *6(
    -\chembelow{C}{H} =CH -C (
      -\chemabove{N}{H} (!\cb C (!\ccb O) -CH_3) % amide
    )
    =\chemabove{C}{H} -HC =[,,2]
  )
}
\definesubmol\paracetamolDev{
  H -[::0] O -[::30] C *6(
    -C (-H) =C (-H) -C (
      -N (!\ch H) (!\cb C (!\ccb O) (-C !\HHH)) % amide
    )
    =C (-H) -C (-H) =
  )
}

%% Aspartame
\definesubmol\aspartame{
  HO -[::90] (!\cch O) !\cb!\cb (!\cb NH_2) % chaine latérale
  !\ch (!\cch O) !\cb \chembelow{N}{H} !\ch % amide
  *6(- (=O) -O (-) !\blank *6(-=-=-) =--) % double cycle
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Molécules odorantes
\definesubmol\geraniol{
  -[::30] (!\cb) !\cch *6( % pied
    !\blank !\blank (- !\cb OH) % chaine latérale
    =(-)--- %fin du cycle
  )
}
\definesubmol\geraniolSemiDev{
  H_3C - C (- CH_3) =[::90] CH % pied
  !\ch H_2C -[::-60,,2,2] H_2C !\cb C % "cycle"
  (!\ch CH_3) !\ccb CH -[::30] CH_2 -OH % chaînes latérales
}
\definesubmol\vanilline{
  HO -[::90,,2] *6(= (-O !\ch) -= (- !\carbonyle H) -=-)
}
\definesubmol\ethylvanilline{
  HO -[::90,,2] *6(= (-O !\chb) -= (- !\carbonyle H) -=-)
}
\definesubmol\oxyphenylone{
  HO -[::30] *6(-=- (-!\cbh (!\cch O) !\cb) =-=)
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Drogues
\definesubmol\THC{
  -[::30] *6( % cyle ether
    (-[::50]) -O- *6( % cycle chaine latérale et alcool
      -= (!\cbh !\cbh !\cb) -= (-OH) -
    )
    =- *6(-=(-)---) -- % cycle supérieur
  )
}
\definesubmol\cocaineHaw{
  ? 
    <[::60,0.7] (-[::60] N -[::60])
    -[::-60,,,,line width = 3pt]
    >[::-30,0.7] ( % ether-phenyl
      !\ch O !\cb (!\ccb O) !\ch *6(=-=-=-)
    )
    -[::130,0.7] ( % ester
      -[::-50] (!\cch O)
      !\cb O !\ch 
    )
    -[::80, 0.9] (-[::-30, 0.85]) -[::60, 0.7] 
  ?
}