%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Réglage de chemfig
\setchemfig{
  atom sep=24pt,
  bond style={line width=1pt},
  angle increment=30
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Pour faire des parenthèses dans les molécules 
\def\parentheseG{\llap{$\left(\strut\right.$}}
\def\parentheseD{\rlap{$\left.\strut\right)$}}

%% Pour avoir des molécules en gras dans un texte
\newcommand{\moleculesGras}{
  \renewcommand*\printatom[1]{\ensuremath{\mathbf{##1}}}
}
\newcommand{\moleculesNormale}{
  \renewcommand*\printatom[1]{\ensuremath{\mathrm{##1}}}
}
\newcommand{\chemfigHaworth}[1]{
  \chemfig[cram width=3pt, atom sep=2.25em]{ #1 }
}

%% parties colorées
\definesubmol\cetoneCouleur{(=[3,,,,couleurQuat] \textcolor{couleurQuat}{O} -[-1,,,,couleurQuat]}
%% ramification
\definesubmol\alkyleG{(-[-5] R_1)}
\definesubmol\alkyleD{(-[-1] R_2)}

%%%% Éléments récurrents 
\newcommand{\hydrogene}{\chemfig{H}}
\newcommand{\carbone}  {\chemfig{C}}
\newcommand{\oxygene}  {\chemfig{O}}
\newcommand{\azote}    {\chemfig{N}}
\newcommand{\electron} {\chemfig{e^{-}}}
%%%% Molécules récurrentes
\newcommand{\dioxygene}          {\chemfig{O_2}}
\newcommand{\diazote}            {\chemfig{N_2}}
\newcommand{\eau}                {\chemfig{H_2O}}
\newcommand{\acideCarbonique}    {\chemfig{H_2CO_3}}
\newcommand{\carbonateDeCalcium} {\chemfig{CaCO_3}}
\newcommand{\bicarbonateDeSodium}{\chemfig{NaHCO_3}}
\newcommand{\azotureDeSodium}    {\chemfig{NaN_3}}
%%%% Ions récurrents
\newcommand{\oxonium}     {\chemfig{H_3O^+}}
\newcommand{\hydroxyde}   {\chemfig{HO^{-}}}
\newcommand{\ionHydrogene}{\chemfig{H^{+}}}
\newcommand{\carbonate}   {\chemfig{CO_3^{2-}}}
\newcommand{\bicarbonate} {\chemfig{HCO_3^{-}}}
\newcommand{\ionFerII}    {\chemfig{Fe^{2+}}}
\newcommand{\ionFerIII}   {\chemfig{Fe^{3+}}}
\newcommand{\ionSodium}   {\chemfig{Na^{+}}}
\newcommand{\ionCuivreII} {\chemfig{Cu^{2+}}}
\newcommand{\ionCalcium}  {\chemfig{Ca^{2+}}}
\newcommand{\ionSulfate}  {\chemfig{SO_4^{2-}}}
\newcommand{\ionNitrate}  {\chemfig{NO_3^{-}}}
\newcommand{\ionChlorure} {\chemfig{Cl^{-}}}
\newcommand{\ionFluorure} {\chemfig{F^{-}}}
\newcommand{\ionMagnesium}{\chemfig{Mg^{2+}}}
\newcommand{\ionPotassium}{\chemfig{K^{+}}}

%%%% État physique
\newcommand{\aq} { \ensuremath{_\text{(aq)}} }
\newcommand{\sol}{ \ensuremath{_\text{(s)}} }
\newcommand{\liq}{ \ensuremath{_\text{(l)}} }
\newcommand{\gaz}{ \ensuremath{_\text{(g)}} }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Pour simplifier certaines molécules
\definesubmol\cu   { -[::60] }  % C-C vers le haut (carbon up)
\definesubmol\cd   { -[::-60] } % C-C vers le bas (carbon down)
\definesubmol\cud  { -[::60] -[::-60] } % Liaison C-C-C ^ (carbon up down)
\definesubmol\cdu  { -[::-60] -[::60] } % Liaison C-C-C v (carbon down up)
\definesubmol\ccu  { =[::60] }  % Liaison C=C vers le haut
\definesubmol\ccd  { =[::-60] } % Liaison C=C vers le haut
\definesubmol\cis  { -[::60] =[::-60] -[::-60] } % Liaison -C=C- cis
\definesubmol\trans{ -[::60] =[::-30] -[::-30] } % Liaison -C=C- trans
%% Hydrogènes saturés
\definesubmol\HH  {(-[::90] H) (-[::-90] H)}
\definesubmol\HHH {(-[::90] H) (-[::-90] H) (-[::0] H)}
%% Quelques groupes caractéristiques
\definesubmol\teteAcide   { O-[::30] (=[::60] O) -[::-60] }
\definesubmol\teteAcideDev{ -O-C (=[::90] O) - }
\definesubmol\carboxyle   { (=[::-60] O) (-[::60] OH) }
\definesubmol\carboxyleDev{ (=[::-50] O) (-[::50] OH) }
\definesubmol\carbonyle   { (=[::60] O) -[::-60] }
\definesubmol\ester       { (=[:90] O) -[:-30] O}
\definesubmol\ether       { -[:30] O -[:-30]}
\definesubmol\amide       { (=[:90] O) -[:-30] N}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Acides gras
\definesubmol\palmitique{
  HO -[::30] !\carbonyle !\cud !\cud !\cud !\cud !\cud !\cud !\cud
}
\definesubmol\linolenique{
  HO -[::30] !\carbonyle !\cud !\cud !\cud !\trans !\trans !\trans !\cu
}
\definesubmol\oleique{
  HO -[::30] !\carbonyle !\cud !\cud !\cud !\cis !\cu !\cud !\cud !\cud
}
\definesubmol\linoleique{
  HO -[::30] !\carbonyle !\cud !\cud !\cud !\cis !\cis !\cud !\cud
}
\definesubmol\arachidonique{
  HO -[::30] !\carbonyle !\cud !\cis !\cis !\cis !\cis !\cu !\cud !\cu
}
\definesubmol\oleiqueSemiDev{
  C_{17} H_{33} -C !\carboxyleDev
}
\definesubmol\oleateSemiDev{
  C_{17} H_{33} -C (=[::-50] O) (-[::50] O^{-})
}
\definesubmol\steraiqueSemiDev{
  C_{17}H_{35} -C !\carboxyleDev
}
\definesubmol\caproiqueSemiDev{
  CH_2 - CH_2 - CH_2 - CH_2 - CH_2 - C !\carboxyleDev
}
%% Pour l'utilisation dans les triglycérides
\definesubmol\tripalmitique{
  !\cdu !\cdu !\cdu !\cdu !\cdu !\cdu !\cd
}
\definesubmol\trilinolenique{
  !\cud !\cud !\cud !\cis !\cis !\cis !\cu
}
\definesubmol\trioleique{
  !\cud !\cud !\cud !\cu !\ccu !\cu !\cud !\cud !\cd !\cd !\cd
}
\definesubmol\trilinoleique{
  !\cud !\cud !\cud !\cis !\cis !\cud !\cud
}
%% Formes semi-developpées
\definesubmol\tristeraiqueSemiDev{
  !\teteAcideDev C_{17}H_{35}
}
\definesubmol\tricaproiqueSemiDev{
  !\teteAcideDev CH_2 - CH_2 - CH_2 - CH_2 - CH_3
}
\definesubmol\trioleiqueSemiDev{
  !\teteAcideDev C_{17} H_{33}
}
\definesubmol\tripalmitiqueSemiDev{
  !\teteAcideDev C_{15} H_{31}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Lipide
\definesubmol\oleine{
   (-[::150] !\cu O !\cd !\carbonyle !\trioleique)
   (-[::-90] !\cd O!\cu !\carbonyle !\trioleique)
   -[::30] O!\cu !\carbonyle !\trioleique
}
\definesubmol\palmitine{
   (-[::150] !\cu O !\cd !\carbonyle !\tripalmitique !\cu) % haut
   (-[::-90] !\cu O !\cu (!\ccd O) !\cu !\tripalmitique !\cu) % bas
   -[::30] O!\cu !\carbonyle !\cu !\tripalmitique % centre
}
\definesubmol\phosphatidylcholine{
  -[::-30] \charge{90:4pt=$+$}{N}
    (-[::-30])(-[::-90])
  !\cud !\cu O !\cd P
    ( =[::-20]O )( -[::-100]\charge{140:2pt=$-$}{O} )
  !\cu O !\cd !\cu
    (!\cu O !\cd !\carbonyle !\trioleique)
  !\cd !\cu O !\cd (!\ccd O) !\cud !\cud !\cud !\cud !\cud
}
\definesubmol\oleineSemiDev{
  H C                 (!\trioleiqueSemiDev)
  (-[3,1.7,2,2] H_2C  (!\trioleiqueSemiDev))
  -[-3,1.7,2,2] H_2 C (!\trioleiqueSemiDev)
}
\definesubmol\caproineSemiDev{
  H C                 (!\tricaproiqueSemiDev)
  (-[3,1.7,2,2] H_2C  (!\tricaproiqueSemiDev))
  -[-3,1.7,2,2] H_2 C (!\tricaproiqueSemiDev)
}
\definesubmol\palmitineSemiDev{
  H C                 (!\tripalmitiqueSemiDev)
  (-[3,1.7,2,2] H_2C  (!\tripalmitiqueSemiDev))
  -[-3,1.7,2,2] H_2 C (!\tripalmitiqueSemiDev)
}

%% glycérol
\definesubmol\glycerol{
  HO !\cdu (!\cu OH) !\cdu OH
}
\definesubmol\glycerolSemiDev{
  HC (-OH)
  (-[3,,2,2] H_2C (-OH))
  -[-3,,2,2] H_2C (-OH)
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Stérols
\definesubmol\cholesterol{
  HO-[1] *6(-- % 1er cycle
    *6(=-- % 2eme cycle
      *6(- % 3eme cycle
        *5(--- 
          (-[::-35] (!\cu) !\cd !\cd !\cud (!\cd) !\cu) % lipide
          -  -
        ) % 4eme
        - (-[::0]) ---
      ) % 3eme
      ---
    ) % 2eme
    - (-[::0]) ---
  ) % 1er
}
\definesubmol\testosterone{
  O=[1] *6(-=
    *6(---
      *6(-
        *5(--- (- OH) --) % 4
      - (-[::0]) ---
      ) % 3
    ---
    ) % 2
  - (-[::0]) ---
  ) % 1
}
\definesubmol\cortisol{
  O=[::30] *6(
    -= *6(
      --- *6(
        - *5(
          --- (-[::-100] OH)
          (-[::-35] (!\ccu O) !\cd!\cu OH)
          -
        ) % 4
        - (-[::0]) -- (-OH) -
      ) % 3
      --
    ) % 2
    - (-[::0]) ---
  ) % 1
}
\definesubmol\progesterone{
  O=[::30] *6(
    -=  *6(
      --- *6(
        - *5(--- (=O) -)
        - (-[::0])
        ---
      ) % 3
      --
    ) % 2
    - (-[::0]) ---
  ) % 1
}

\definesubmol\estradiol{
    HO-[::30] *6(
    -= *6(
      --- *6(
        - *5(--- (-OH) -)
        - (-[::0]) ---
      ) % 3
      --
    ) % 2
    -=-=
  ) % 1
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Glucides
%% Pour la représentation de Haworth
\definesubmol\gluHaw{
  <[-1.5, 0.7] (-[:90, 0.6] OH)
  -[::45,,,,line width = 3.4pt] (-[:-90, 0.6] OH)
  >[::45, 0.7]
}
\definesubmol\gluLeftHaw{
  <[-4.5, 0.7] (-[:-90, 0.6] OH)
  -[::-45,,,,line width = 3.4pt] (-[:90, 0.6] OH)
  >[::-45, 0.7] (-[1.5,0.7])
}
%% Pour faciliter l'écriture d'un sucre en formule développée
\definesubmol{\ose} { -[::0] C (-[::-90] H) (-[::90] OH) }

%% Amidon
\definesubmol\amylopecHaw{
  % début du cycle
  O -[1,0.6]
  !\gluHaw
  (-[4.5,0.7] O
  -[6] (-[3,0.5] -[5,0.75] OH)
  -[-4.5,0.7])
  % fin du cycle
  -[-1,0.6]
}
\definesubmol\amylopecGaucheHaw{
  O -[5,0.6]
  % début du cycle, perspective
  !\gluLeftHaw  (-[-5,0.6] O -[5] ...)
  % fin du cycle
  -[1.5,0.7] (-[3,0.4] -[5,0.6] OH)
  -O -[-1.5,0.7]
}
\definesubmol\amylopecCentraleHaw{
  O -[-1,0.7] -[-3,0.6]
  % début du cycle
  - O -[-1.5,0.7] ( % perspective
    !\gluLeftHaw  (-[-5,0.6] !\amylopecGaucheHaw)
  )
  % fin du cycle
  -[-1,0.6]
}
\definesubmol\amylopectineHaw{
  ...\phantom{B} -[::-30] !\amylopecHaw !\amylopecHaw O !\cd
  !\amylopecCentraleHaw
  !\amylopecHaw !\amylopecHaw O !\cu ...
}

%% glucose
\definesubmol\glucoseHaw{
  % début du cycle
  HO -[::90,0.6,2]? % with space between ,,, there is a strange pgf bug here...
  !\gluHaw (-[::-135, 0.6] OH) -[::90, 0.7] O 
  % fin du cycle
  -[::45]? (-[::-90, 0.5] -[::60, 0.75] OH)
}
\definesubmol\glucoseCycle{
  HO -[::30] *6 (-(-OH) -(-OH) -(-OH) -O- (- !\cd OH)-)
}
\definesubmol\glucose{
  H -[::30] (!\ccu O) !\cd (!\cd OH) !\cu (!\cu OH) !\cd (!\cd OH) !\cu (!\cu OH) !\cd !\cu OH
}
\definesubmol\glucoseSemiDev{
  C (-[::120] H) (=[::-120] O) !\ose !\ose !\ose !\ose !\ose (-[::0] OH)
}

%% fructose
\definesubmol\fructoseHaw{
  % début du cycle
  HO -[::90,0.6,2]? % with space between ,,, there is a strange pgf bug here...
  !\gluHaw (-[::-135, 0.5] -[::60, 0.75] OH) (-[::45] OH) -[::90, 0.7] O
  % fin du cycle
  -[::45]?
}
\definesubmol\fructoseCycle{
  HO -[::30] *6 (-(-OH) -(-OH) -(-[::0] OH) (-[::-90] !\cu OH) -O--)
}
\definesubmol\fructose{
  HO -[::30] !\cd (!\ccd O) !\cu (!\cu OH) !\cd (!\cd OH) !\cu (!\cu OH) !\cd !\cu OH
}
\definesubmol\fructoseSemiDev{
  OH -[::0]  C!\HH -[::0] C (=[::90] O) !\ose !\ose !\ose !\ose (-[::0] H)
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Acides alpha aminés
\definesubmol\isoleucine{
  H_2N -[1] (-[3] (-[1]) -[5] -[3]) -[-1] !\carboxyle
}
\definesubmol\leucine{
  H_2N -[1] (-[3] -[5] (-[-5]) -[3]) -[-1] !\carboxyle
}
\definesubmol\methionine{
  H_2N -[1] (-[3] -[5] -[3] S -[5]) -[-1] !\carboxyle
}
\definesubmol\valine{
  H_2N -[1] (-[3] (-[1]) -[5]) -[-1] !\carboxyle
}
\definesubmol\alanineSemiDev{
  CH_3- CH (-[-3] NH_2) - C !\carboxyleDev
}
\definesubmol\asparagineSemiDev{
  HO -[1]C (=[3] O) -[-1]CH (-[-3] NH_2) -[1]CH_2 -[-1]C (-[-3] NH_2) =[1] O
}
\definesubmol\glycineSemiDev{
  CH_2 (-[-3] NH_2) -C !\carboxyleDev
}
\definesubmol\cysteineSemiDev{
   HS - CH_2 - CH (-[-3] NH_2) -C !\carboxyleDev
}
\definesubmol\cysteinePoly{
  - CH_2 - CH (-[-3] NH_2) -C (=[3] O) -
}
\definesubmol\alaninePoly{
  - CH (-[-3] CH_3) - C (=[3] O) -
}
\definesubmol\glycinePoly{
  - CH_2 - C (=[3] O) -
}
\definesubmol\isoleucinePoly{
  -CH (-[-3] CH (-[-5] CH_2 -[-3]CH_3) -[-1]CH_2) -C (=[3] O) -
}
\definesubmol\valinePoly{
  -CH (-[3] CH (-[5] CH_3) -[1]CH_2) -C (=[-3] O) -
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Hormones
\definesubmol\creatinine{
  O= *5(-N (-[-3,0.5]H) -(=NH) -N (-) --)
}
\definesubmol\DOPA{
  HO -[1] *6(= (-OH) -= (--[-1] (-[-3]NH_2) -[1] COOH) -=-)
}
\definesubmol\DOPAH{
  HO -[1] *6(= (-OH) -= (--[-1] (-[-3]NH_3^+) -[1] COOH) -=-)
}
\definesubmol\prostaglandine{
  HO-[::75] *5(
    - (-!\ccu !\cd (!\cd HO) !\cud !\cud !\cu)
    - (-[::-65] !\cdu !\cdu !\cdu !\carboxyle)
    - (=O)
    --
  )
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Produit de contraste
\definesubmol\ionChelate{
  N (-[::-45, 0.9,,, draw = none] Gd^{3+})
      (-[::140] !\cd COO^{-}) -[::80] -[ 0] -[::-80]
    N (-[::140] !\cd COO^{-}) -[::70] -[-3] -[::-80]
    N (-[::120] !\cd COO^{-}) -[::70] -[-6] -[::-80]
    N (-[::140] !\cd ^{-}OOC) -[::70] -[ 3] -[::-80, 0.8]
}
\definesubmol\chelateAlcool{
  N (-[::-45, 0.9,,, draw = none] Gd^{3+})
    (-[::140] !\cd COO^{-})         -[::80] -[ 0] -[::-80]
  N (-[::140] -[0] (-[2] OH) -[-2]) -[::70] -[-3] -[::-80]
  N (-[::120] !\cd COO^{-})         -[::70] -[-6] -[::-80]
  N (-[::140] !\cd ^{-}OOC)         -[::70] -[ 3] -[::-80, 0.8]
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Vitamines
\definesubmol\acideAscorbique{ % Vitamine C
  HO-[-1] -[1](-[3]OH) -[-1] 
  *5(
    -(-OH) =(-OH) -(=O) -O-
  )
}
\definesubmol\cholecarciferol{ % Vitamine D
  OH-[-1]
  *6( % 1er cycle
    ---(=)- ( % ramification
      = !\cd !\ccu *6(- % 2eme
        *5(
          --- (-(-[::60]) !\cd !\cud -[::60](-[::60]) !\cd) --
        ) % 3eme
        -(-[::0])----
      ) % 2eme
    ) % ramification
    --
  ) % 1er
}
\definesubmol\cret{ =[-1] -[1] }
\definesubmol\retinol{ % Vitamine A
  *6( % cycle
    --(-)= ( % chaine
      -[1] !\cret (-[3]) !\cret !\cret (-[3]) !\cret OH
    ) % chaine
    -(-[1]) (-[5])--
  ) % cycle
}
% vitamine B1 thiamine
\definesubmol\thiamine{
  -[::30]  *6(
    -N=- (
      - !\cd N  *5(
        - (-)
        = (- !\cu !\cd OH)
        -S-=
      ) % 2nd cycle
    )
    = (-  NH_2)
    -N=
  ) % 1er cycle
}
% vitamine B2 riboflavine
\definesubmol\riboflavine{
  -[::30]  *6(
    =- ( *6(
        - N (
        !\cdu (!\cu OH)
        !\cd (!\cd OH)
        !\cu (!\cu OH)
        !\cd !\cu OH
      )
      - ( *6(=N- (=O) -NH- (= O)-) )
      -=N-
    ))
    =-= (-) -
  )
}
% vitamine B3 acide nicotinique
\definesubmol\acideNicotinique{
   *6(-N=- (- (!\ccu O) !\cd OH) =-=)
}
% vitamine B5 acide panthotenique
\definesubmol\acidePanthotenique{
  HO -[::30] !\cd (-[::-90]) (-[::-30])
  !\cu ( !\cu OH )
  !\cd (!\ccd O )
  !\cu NH !\cdu !\cd (!\ccd O )
  !\cu OH
}
% vitamine B6 pyroxidine
\definesubmol\pyroxidine{
  HO -[::30] !\cd  *6(
    =-N= (-)
    - (-OH)
    = (!\cd OH)
    -
  )
}
% vitamine B8 biotine
\definesubmol\biotine{
  NH
   *5(
    - *5(--S- (- !\cdu !\cd) -)
    --NH- (= OH)
    -
  )
}
% vitamine B9 acide folique
\definesubmol\acideFolique{
  H_2N -[::30]  *6(
    =N- *6(
      -N=- (
        - !\cu NH !\cd  *6(
          =-= (
            - (!\ccu O )
            !\cd NH !\cu (
              !\cu ( !\cu OH )
              =[::-60] O
            )
            !\cd !\cdu (!\cu OH)
            !\ccd O
          )
          -=-
        ) % 3eme cycle
      )
      =N-
    ) % 2nd cycle
    =- ( =O ) -N-
  ) % 1er cycle
}
% vitamine B12 cyanocobalamine
\definesubmol\cyanocobalamine{
  -[::-5]  *5( % cycle haut droit du cobalt
    (-[::150] -[::-50] (!\ccd O) !\cu NH_2)
    - (-[::-90]) (-[::-35])
    - N = (
      - (!\cu) !\ccd *5( % cycle haut gauche du cobalt
        - N = (
          -!\ccd *5( % cycle bas gauche du cobalt
            - N = (
              - (!\cu) !\ccd *5( % cobalt
                - N (-Co !\cu CN)
                -- (- !\cd (!\ccd O) !\cu NH_2)
                - (-[::-90]) ( % Phosphate
                  - !\cud (!\ccd O)
                  !\cu NH !\cdu (!\cu)
                  !\cd O !\cu P (=[::90] O)
                  (-[::-90] OH)
                  -[::0] O -[::0] *5( % cycle du bas ether
                    - (- !\cu HO)
                    - O - (
                      -N  *5( % Cycle du bas amidine
                        -  *6(=- (-) = (-) -=)
                        -- N =-
                      )
                    )
                    - (-OH) -
                  )
                )
                -
              )
            ) % Amide latéral
            - (- !\cud (!\ccd O) !\cu NH_2)
            - (-[::-30])  (-[::-90]) -
          )
        ) % cycle 
        - (- !\cdu (!\ccu O) !\cd NH_2)
        - (-[::0]) (!\cd!\cd (!\ccu O) !\cd NH_2)
        -
      )
    )
    - (- !\cdu (!\ccd O) !\cu NH_2)
    - 
  ) % 1er cycle
}
% vitamine E
\definesubmol\vitamineE{
  -[::30]  *6(
    = (-) -  *6(
      -O- (
        - !\cud !\cu (!\cu)
        !\cdu !\cdu (!\cu)
        !\cdu !\cdu (!\cu) !\cd
      )
      ( -[::0] )
      ---
    ) % 2nd cycle
    =- (-) = ( -HO )
    -
  ) % 1er cycle
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Aspirine
\definesubmol\aspirineSemiDev{
  *6( % cycle
    -\chembelow{C}{H} =CH -C (
      -O !\cd C (!\ccd O) !\cu CH_3 % chaine latérale
    )
    =C (-C !\carboxyle)-=HC =[,,2,2]HC 
  ) % cyle
}
\definesubmol\aspirine{
  *6 (-=- (-O !\cd (!\ccd) !\cu) = (- !\carboxyle) -=)
}

%% Paracétamol
\definesubmol\paracetamol{
  HO -[::30] *6(
    -=- (-\chemabove{N}{H} (!\cd (!\ccd O) !\cu)) % Amide
    =-=
  )
}
\definesubmol\paracetamolSemiDev{
  HO -[::30] C *6(
    -\chembelow{C}{H} =CH -C (
      -\chemabove{N}{H} (!\cd C (!\ccd O) -CH_3) % Amide
    )
    =\chemabove{C}{H} -HC =[,,2]
  )
}
\definesubmol\paracetamolDev{
  H -[::0] O -[::30] C *6(
    -C (-H) =C (-H) -C (
      -N (!\cu H) (!\cd C (!\ccd O) (-C !\HHH)) % Amide
    )
    =C (-H) -C (-H) =
  )
}

%% Aspartame
\definesubmol\aspartame{
  [:150]
  *6(-=-=-=) % phenyl
  -[0]-[-2] (
    -[-4] (=[6]O) -[-2]O -[-4]
  ) % ester
  -[0]NH -[-2,,1] (=[-4] O) % Amide
  -[0] (
    -[2] NH_2
  ) % amine
  -[-2] -[0] (=[2] O) -[-2] OH % acide carboxylique
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Molécules odorantes
%% géraniol
\definesubmol\geraniol{
  -[-3] *6( % tete
    --- (= (!\cd) (!\cu)) % pied
    -[,,,,draw=none] -[,,,,draw=none] (- !\cd OH) % alcool
    =
  )
}
\definesubmol\geraniolSemiDev{
  H_3C -[-3]C *6 ( % tete
    -H_2C -[,,2,2] H_2C -CH 
      (=C (!\cd CH_3) (!\cu CH_3)) % pied
    -[,,1,1,draw=none] -[,,,,draw=none] CH
      (-CH_2 !\cd OH) % alcool
    =CH_2
  )
}
\definesubmol\oxyphenylone{
  HO -[::30] *6(
    -=- (-!\cd !\cu (!\ccu O) !\cd)
    =-=
  )
}
\definesubmol\vanilline{
  O=[::-30] (!\cu H)
  !\cd  *6(
    - = - (-OH)
    = (-O !\cu)
    -=
  )
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Drogues
\definesubmol\THC{
  -[::-90] *6 ( % 1er
    --- *6 ( % 2eme
      - (-[::-90]) (-[::-30])
      -O- *6 ( % 3eme
        -= (!\cd !\cud !\cud)
        -= (!\cd OH) -=
      )
      --
    )
    --=
  )
}
\definesubmol\cocaineHaw{
  ? 
    <[::60,0.7] (-[::60] N -[::60])
    -[::-60,,,,line width = 3.4pt]
    >[::-30,0.7] ( % ether-phenyl
      !\cu O !\cd (!\ccd O) !\cu *6(=-=-=-)
    )
  -[::130,0.7] ( % ester
    -[::-50] (!\ccu O)
    !\cd O !\cu 
  )
  -[::80, 0.9] (-[::-30, 0.85]) -[::60, 0.7] ?
}
